# 2회차 스터디 2019-02-01

## 스프링 부트 배치로 만들 기능

- 휴면회원 전환  
    - 장기간 접속하지 않은 이용자를 휴면회원으로 전환해야하는 이슈가 발생했다.
    - 휴면회원을 일괄 전환하는 기능을 현재의 프로젝트로 추가하자니 마땅한 곳이 없을 때 사용한다.

> 배치(Batch)란?  
> 프로그램의 흐름에 따라 순차적으로 자료를 처리한다 ≈ 일괄처리

## 스프링 부트 배경 지식

> 출처 : 처음 배우는 스프링 부트 2 - 김영재 지음 (한빛미디어)  
> p.237 ~ p.239

## 배경지식

Spring Boot Batch : 피보탈*Pivotal*과 액센츄어*Accenture*의 공동 개발 합작품

### 배치처리에 스프링 부트 배치를 써야 하는 이유

- 대용량 데이터 처리에 최적화되어 고성능을 발휘한다.
- 효과적인 로깅, **통계 처리**, 트랜잭션 관리등 재사용 가능한 필수 기능을 지원한다.
- 수동으로 처리하지 않도록 자동화했다.
- 예외 사항과 비정상 동작에 대한 방어 기능이 있다.
- 스프링 부트 배치의 반복 작업 프로세스를 이해하면 비즈니스 로직에 집중해서 개발할 수 있다.

### 스프링 부트 배치 2.0

스프링 배치 4.0을 기반으로 간편하게 사용할 수 있도록 랩핑한 스프링 부트용 배치 프레임워크

- 자바 8 이상에서 동작. 함수형 인터페이스 & 람다식 지원으로 편리한 개발 가능
- 스프링 5부터 재배열된 의존성 트리를 지원
- ItemReaders, ItemProcessors, ItemWriters에 대한 빌더 제공

### 스프링 부트 배치 주의 사항

1. 되도록 단순화해서 복잡한 구조와 로직을 피한다.
2. 데이터를 직접 사용하는 작업이 빈번하므로 데이터 무결성을 유지하는 방어책이 필수다.
3. 배치 처리 시 성능에 영향을 줄 수 있으므로 시스템 I/O 사용을 최소화한다.  
    한번에 데이터를 조회하여 메모리에 저장해두고 처리 후 한번에 DB에 저장하는 것이 좋다.
4. 같은 서비스에 사용되는 많은 프로젝트들에 영향을 줄 수 있으므로 주의를 기울여야한다.
5. 스프링 부트 배치는 배치처리 기능만 제공하며 스케쥴러를 제공하지 않는다.  

> 스케줄링 기능은 스프링에서 제공하는 쿼츠 프레임워크(Quartz Framework) 등을 이용해야 한다.  
> 리눅스 crontab 명령은 가장 간단한 방법이지만 추천하지 않는다.  
> crontab의 경우 각 서버마다 따로 스케줄링을 관리해야하며 클러스터링 기능이 제공되지 않기 때문이다.  
> 쿼츠와 같은 프레임워크를 사용하면 클러스터링 외에도 다양한 기능과 실행 이력 관리등 이점이 많다.

